"use strict";(self.webpackChunk_solflare_extension=self.webpackChunk_solflare_extension||[]).push([["libs_shared_dist_components_FullScreenLoading_index_js-libs_shared_dist_components_ValidatorA-cc1b15"],{"../../libs/shared/dist/components/FullScreenLoading/index.js":(e,s,t)=>{t.d(s,{S:()=>o});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js"),a=t("../../libs/foundation-ui/dist/index.js");const r=(0,n.Z)("div")({height:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center"}),o=()=>(0,i.jsx)(r,{children:(0,i.jsx)(a.Loader,{size:"l"})})},"../../libs/shared/dist/components/ValidatorAvatar/index.js":(e,s,t)=>{t("../../../node_modules/react/jsx-runtime.js")},"../../libs/shared/dist/features/currencies/components/DisplayComputedFiatValue/index.js":(e,s,t)=>{t.d(s,{s:()=>o});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../libs/shared/dist/utils/displayPrice.js"),a=t("../../libs/shared/dist/features/currencies/hooks/index.js"),r=t("../../libs/shared/dist/features/currencies/utils/index.js");const o=({value:e,displayType:s="value",showSign:t,suffix:o,hidePreffix:d})=>{const l=(0,a.Af)(),c=(0,r.MK)(l.ticker,l.symbol);return(0,i.jsxs)(i.Fragment,{children:[t&&(+e<0?"-":"+"),(0,n.ED)({amount:t?Math.abs(+e):+e,prefix:d?"":c,displayType:s,suffix:o})]})}},"../../libs/shared/dist/features/currencies/hooks/useCurrencyDisplay.js":(e,s,t)=>{t.d(s,{_:()=>n});var i=t("../../libs/shared/dist/features/globalConfig/context/index.js");const n=(e,s="fiat")=>{const{currencyDisplay:t}=(0,i.A)();return t[e]||s}},"../../libs/shared/dist/features/currencies/utils/symbolFormatter.js":(e,s,t)=>{t.d(s,{M:()=>a});const i=e=>`${e} `,n={BHD:i,CHF:i,CZK:i,DKK:i,HUF:i,KWD:i,LKR:i,MMK:i,NOK:i,PKR:i,PLN:i,RUB:i,SAR:i,SEK:i,VEF:i},a=(e,s)=>n[e]?n[e](s||e):s||e},"../../libs/shared/dist/features/dappCommunication/components/MessageAnalysisLoading/index.js":(e,s,t)=>{t.d(s,{K:()=>o});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/hooks/useMetamask/index.js");const o=()=>{const{t:e}=(0,n.$)(),{isMetamask:s}=(0,r.U)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.TXSimulationList,{children:(0,i.jsx)(a.Section,{variant:"m",children:(0,i.jsx)(a.TXSimulationSection,{title:(0,i.jsx)(a.SectionTitle,{title:e("transaction_message"),tooltip:(0,i.jsx)(a.InfoWithTooltip,{tooltip:e("transaction_message_tooltip")})}),children:(0,i.jsx)(a.TXMessageLoading,{})})})}),(0,i.jsx)(a.FooterActions,{variant:"inContent",children:!s&&(0,i.jsxs)(a.ButtonGroup,{children:[(0,i.jsx)(a.Button,{variant:"secondary",disabled:!0,children:e("action_reject_case")}),(0,i.jsx)(a.Button,{disabled:!0,children:e("action_approve_case")})]})})]})}},"../../libs/shared/dist/features/dappCommunication/components/SignAllSerializedTransactions/index.js":(e,s,t)=>{t.d(s,{w:()=>v});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/features/transactionAnalysis/components/index.js"),o=t("../../libs/shared/dist/features/transactionAnalysis/queries/index.js"),d=t("../../libs/shared/dist/features/transactionAnalysis/utils/index.js"),l=t("../../libs/shared/dist/features/dappCommunication/hooks/index.js"),c=t("../../libs/shared/dist/features/dappCommunication/hooks/useAutoApprove.js"),u=t("../../../node_modules/react/index.js"),p=t("../../../node_modules/@solana/web3.js/lib/index.browser.esm.js"),m=t("../../../node_modules/base64-js/index.js"),j=t("../../../node_modules/bs58/index.js"),h=t.n(j),y=t("../../libs/shared/dist/context/solana/useDappSolanaConnection.js"),x=t("../../libs/shared/dist/features/transactionAnalysis/context/index.js"),b=t("../../libs/shared/dist/features/transactionFlow/hooks/index.js"),f=t("../../libs/shared/dist/features/walletData/hooks/index.js"),g=t("../../libs/shared/dist/features/dappCommunication/constants.js"),A=t("../../libs/shared/dist/features/dappCommunication/context/index.js"),w=t("../../libs/shared/dist/features/dappCommunication/utils/index.js"),_=t("../../../node_modules/console-browserify/index.js");const v=({transactions:e,onSign:s,onReject:t})=>{const{t:j}=(0,n.$)(),v=(0,l.ZY)(e),{simulationResults:T,serializedTransactions:S,isPending:C,queryKey:k}=(0,o.My)(v,"signAllTransactions"),K=(0,l.j2)({queryKey:k}),{sign:B,reject:R,isSigning:P}=((e,s,t,i)=>{const{getSendConnection:n}=(0,y.U)(),a=(0,b.mx)(),{publicKey:r,walletType:o}=(0,f.rT)(),{origin:d}=(0,A.N)(),{sendMultipleTransactions:l}=(0,b.pQ)(),{isBlockhashExpiredRef:c}=(0,x.C)(),[j,v]=(0,u.useState)(!1),T=async()=>{await(i?.({type:"reject"})),t()};return{sign:async({autoApprove:t=!1}={})=>{try{v(!0);const u=e.map((e=>(0,m.toByteArray)(e))),j=await(0,w.mW)(a,u.map(h().encode));if(c.current)return;if(g.L3)try{const e=j.map((e=>p.VersionedTransaction.deserialize(h().decode(e)))),s=n({origin:d??"",autoApprove:t??!1,method:"sign"});await l({connection:s,transactions:e})}catch{_.log("failed to send transactions")}await(i?.({type:"sign",autoApprove:t})),s(j,{publicKey:r,walletType:o,autoApprove:t})}catch(e){if(c.current)return;await T()}finally{v(!1)}},reject:T,isSigning:j}})(S,s,t,K);return(0,c.d)((()=>B({autoApprove:!0}))),(0,i.jsx)(r.BY,{title:(0,i.jsx)(a.PageTitle,{center:j("approve_transaction_few")}),simulationResults:T,isLoading:C,isSigning:P,onReject:R,onApprove:B,analysisPreview:(0,d.Zb)(T)&&(0,i.jsx)(a.TXSimulationList,{children:T.transactions.map(((e,s)=>(0,i.jsx)(r.ND,{transaction:e,rawTransaction:S[s]},s)))})})}},"../../libs/shared/dist/features/dappCommunication/components/SignAllTransactionMessages/index.js":(e,s,t)=>{t.d(s,{O:()=>_});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/features/transactionAnalysis/components/index.js"),o=t("../../libs/shared/dist/features/transactionAnalysis/queries/index.js"),d=t("../../libs/shared/dist/features/transactionAnalysis/utils/index.js"),l=t("../../libs/shared/dist/features/dappCommunication/hooks/index.js"),c=t("../../libs/shared/dist/features/dappCommunication/hooks/useAutoApprove.js"),u=t("../../../node_modules/react/index.js"),p=t("../../../node_modules/@solana/web3.js/lib/index.browser.esm.js"),m=t("../../../node_modules/base64-js/index.js"),j=t("../../../node_modules/bs58/index.js"),h=t.n(j),y=t("../../libs/shared/dist/context/solana/useDappSolanaConnection.js"),x=t("../../libs/shared/dist/features/transactionAnalysis/context/index.js"),b=t("../../libs/shared/dist/features/transactionFlow/hooks/index.js"),f=t("../../libs/shared/dist/features/walletData/hooks/index.js"),g=t("../../libs/shared/dist/features/dappCommunication/constants.js"),A=t("../../libs/shared/dist/features/dappCommunication/context/index.js"),w=t("../../libs/shared/dist/features/dappCommunication/utils/index.js");const _=({messages:e,onSign:s,onReject:t})=>{const{t:j}=(0,n.$)(),_=(0,l.bL)(e),{simulationResults:v,isPending:T,queryKey:S}=(0,o.mG)(_,"signAllTransactions"),C=(0,l.j2)({queryKey:S}),{sign:k,reject:K,transactions:B,isSigning:R}=((e,s,t,i)=>{const{getSendConnection:n}=(0,y.U)(),a=(0,b.mx)(),{publicKey:r,walletType:o}=(0,f.rT)(),{origin:d}=(0,A.N)(),{sendMultipleTransactions:l}=(0,b.pQ)(),{isBlockhashExpiredRef:c}=(0,x.C)(),[j,_]=(0,u.useState)(!1),v=(0,u.useMemo)((()=>e.reduce(((e,s)=>{const t=p.VersionedMessage.deserialize((0,m.toByteArray)(s)),i=new p.VersionedTransaction(t);return[...e,(0,m.fromByteArray)(i.serialize())]}),[])),[e]),T=async()=>{await(i?.({type:"reject"})),t()};return{sign:async({autoApprove:t=!1}={})=>{try{_(!0);const u=e.map((e=>(0,m.toByteArray)(e))),j=await(0,w.Se)(a,u.map((e=>h().encode(e))));if(c.current)return;if(g.L3)try{const e=u.map(((e,s)=>{const t=p.VersionedMessage.deserialize(e),i=new p.VersionedTransaction(t);return i.addSignature(new p.PublicKey(a.publicKey),h().decode(j[s])),i})),s=n({origin:d??"",autoApprove:t??!1,method:"sign"});await l({connection:s,transactions:e})}catch{}await(i?.({type:"sign",autoApprove:t})),s(j,{publicKey:r,walletType:o,autoApprove:t})}catch(e){if(c.current)return;await T()}finally{_(!1)}},reject:T,transactions:v,isSigning:j}})(_,s,t,C);return(0,c.d)((()=>k({autoApprove:!0}))),(0,i.jsx)(r.BY,{title:(0,i.jsx)(a.PageTitle,{center:j("approve_transaction_few")}),simulationResults:v,isLoading:T,isSigning:R,onReject:K,onApprove:k,analysisPreview:(0,d.Zb)(v)&&(0,i.jsx)(a.TXSimulationList,{children:v.transactions.map(((e,s)=>(0,i.jsx)(r.ND,{transaction:e,rawTransaction:B[s]},s)))})})}},"../../libs/shared/dist/features/dappCommunication/components/SignAndSendSerializedTransaction/index.js":(e,s,t)=>{t.d(s,{$:()=>w});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/features/transactionAnalysis/components/index.js"),o=t("../../libs/shared/dist/features/transactionAnalysis/queries/index.js"),d=t("../../libs/shared/dist/features/transactionAnalysis/utils/index.js"),l=t("../../libs/shared/dist/features/dappCommunication/hooks/index.js"),c=t("../../libs/shared/dist/features/dappCommunication/hooks/useAutoApprove.js"),u=t("../../../node_modules/react/index.js"),p=t("../../../node_modules/base64-js/index.js"),m=t("../../../node_modules/bs58/index.js"),j=t.n(m),h=t("../../libs/shared/dist/context/solana/useDappSolanaConnection.js"),y=t("../../libs/shared/dist/features/transactionAnalysis/context/index.js"),x=t("../../libs/shared/dist/features/transactionFlow/hooks/index.js"),b=t("../../libs/shared/dist/features/walletData/hooks/index.js"),f=t("../../libs/shared/dist/features/dappCommunication/constants.js"),g=t("../../libs/shared/dist/features/dappCommunication/context/index.js"),A=t("../../libs/shared/dist/features/dappCommunication/utils/index.js");const w=({transaction:e,sendOptions:s,onSign:t,onReject:m})=>{const{t:w}=(0,n.$)(),_=(0,l.ZY)(e),{simulationResults:v,serializedTransactions:T,isPending:S,queryKey:C}=(0,o.My)(_,"signAndSendTransaction"),k=(0,l.j2)({queryKey:C}),{signAndSend:K,reject:B,isSigning:R}=((e,s,t,i,n)=>{const a=(0,x.mx)(),{getSendConnection:r}=(0,h.U)(),{origin:o}=(0,g.N)(),{publicKey:d,walletType:l}=(0,b.rT)(),{isBlockhashExpiredRef:c}=(0,y.C)(),[m,w]=(0,u.useState)(!1),_=async e=>{await(n?.({type:"reject"})),i(e)};return{signAndSend:async({autoApprove:i=!1}={})=>{try{w(!0);const u=await(0,A.pE)(a,j().encode((0,p.toByteArray)(e)));if(c.current)return;let m;m=f.ZD?u:await r({origin:o??"",autoApprove:i??!1,method:"signAndSend"}).sendRawTransaction(j().decode(u),s),await(n?.({type:"sign",autoApprove:i})),t(m,{publicKey:d,walletType:l,autoApprove:i})}catch(e){if(c.current)return;await _(e?.message)}finally{w(!1)}},reject:_,isSigning:m}})(T[0],s,t,m,k);return(0,c.d)((()=>K({autoApprove:!0}))),(0,i.jsx)(r.BY,{title:(0,i.jsx)(a.PageTitle,{center:w("approve_transaction_one")}),simulationResults:v,isLoading:S,isSigning:R,onReject:B,onApprove:K,analysisPreview:(0,d.Zb)(v)&&(0,i.jsx)(a.TXSimulationList,{children:v.transactions.map(((e,s)=>(0,i.jsx)(r.ND,{transaction:e,rawTransaction:T[s]},s)))})})}},"../../libs/shared/dist/features/dappCommunication/components/SignMessage/index.js":(e,s,t)=>{t.d(s,{Q:()=>g});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react/index.js"),a=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),r=t("../../../node_modules/base64-js/index.js"),o=t("../../../node_modules/lodash/lodash.js"),d=t("../../libs/foundation-ui/dist/index.js"),l=t("../../libs/shared/dist/features/transactionAnalysis/components/index.js"),c=t("../../libs/shared/dist/features/transactionAnalysis/queries/index.js"),u=t("../../libs/shared/dist/features/transactionAnalysis/types.js"),p=t("../../libs/shared/dist/features/dappCommunication/hooks/index.js"),m=t("../../libs/shared/dist/features/dappCommunication/hooks/useAutoApprove.js"),j=t("../../../node_modules/bs58/index.js"),h=t.n(j),y=t("../../libs/shared/dist/features/transactionAnalysis/context/index.js"),x=t("../../libs/shared/dist/features/transactionFlow/hooks/index.js"),b=t("../../libs/shared/dist/features/dappCommunication/utils/index.js"),f=t("../../libs/shared/dist/features/dappCommunication/components/MessageAnalysisLoading/index.js");const g=({message:e,display:s,onSign:t,onReject:j})=>{const{t:g}=(0,a.$)(),A=(0,n.useMemo)((()=>{if((0,o.isEmpty)(e))return"";try{return(0,r.fromByteArray)(function(e){if(e.length)return Uint8Array.from(e);{const s=(0,o.max)((0,o.keys)(e).map((e=>parseInt(e,10))))||0;return Uint8Array.from({...e,length:s+1})}}(e))}catch{return""}}),[e]),{isPending:w,simulationResults:_,isTransactionDetected:v,queryKey:T}=(0,c.cK)(A),S=(0,p.j2)({queryKey:T}),{sign:C,reject:k,decodedMessage:K}=((e,s,t,i,o)=>{const d=(0,x.mx)(),{t:l}=(0,a.$)(),{isBlockhashExpiredRef:c}=(0,y.C)(),u=(0,n.useMemo)((()=>(0,b.my)((0,r.toByteArray)(e),s)??l("error_unable_to_decode_message")),[s,e,l]),p=async()=>{await(o?.({type:"reject"})),i()};return{sign:async()=>{try{if((0,b.nO)((0,r.toByteArray)(e)))throw new Error("Transaction detected");const s=await(0,b.l)(d,h().encode((0,r.toByteArray)(e)));if(c.current)return;await(o?.({type:"sign"})),t(s)}catch(e){if(c.current)return;p()}},reject:p,decodedMessage:u}})(A,s,t,j,S);return(0,m.d)(C),(0,i.jsx)(l.W2,{title:(0,i.jsx)(d.PageTitle,{center:g("transaction_sign_message")}),children:v?(0,i.jsx)(l.RD,{alerts:[{key:u.B.INVALID_TRANSACTION,severity:"error",title:g("transaction_scam_site_detected_title"),message:g("transaction_scam_site_detected_message")}],onReject:k}):w?(0,i.jsx)(f.K,{}):(0,i.jsx)(l.Nr,{simulationResults:_,onApprove:C,onReject:k,analysisPreview:(0,i.jsx)(d.TXSimulationList,{children:(0,i.jsx)(d.Section,{variant:"m",children:(0,i.jsx)(d.TXMessage,{title:(0,i.jsx)(d.SectionTitle,{title:g("transaction_message"),tooltip:(0,i.jsx)(d.InfoWithTooltip,{tooltip:g("transaction_message_tooltip")})}),children:(0,i.jsx)(d.Paragraph,{size:"s",children:K})})})})})})}},"../../libs/shared/dist/features/dappCommunication/components/SignSerializedTransaction/index.js":(e,s,t)=>{t.d(s,{b:()=>w});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/features/transactionAnalysis/components/index.js"),o=t("../../libs/shared/dist/features/transactionAnalysis/queries/index.js"),d=t("../../libs/shared/dist/features/transactionAnalysis/utils/index.js"),l=t("../../libs/shared/dist/features/dappCommunication/hooks/index.js"),c=t("../../libs/shared/dist/features/dappCommunication/hooks/useAutoApprove.js"),u=t("../../../node_modules/react/index.js"),p=t("../../../node_modules/base64-js/index.js"),m=t("../../../node_modules/bs58/index.js"),j=t.n(m),h=t("../../libs/shared/dist/context/solana/useDappSolanaConnection.js"),y=t("../../libs/shared/dist/features/transactionAnalysis/context/index.js"),x=t("../../libs/shared/dist/features/transactionFlow/hooks/index.js"),b=t("../../libs/shared/dist/features/walletData/hooks/index.js"),f=t("../../libs/shared/dist/features/dappCommunication/constants.js"),g=t("../../libs/shared/dist/features/dappCommunication/context/index.js"),A=t("../../libs/shared/dist/features/dappCommunication/utils/index.js");const w=({transaction:e,onSign:s,onReject:t})=>{const{t:m}=(0,n.$)(),w=(0,l.ZY)(e),{isPending:_,simulationResults:v,serializedTransactions:T,queryKey:S}=(0,o.My)(w,"signTransaction"),C=(0,l.j2)({queryKey:S}),{sign:k,reject:K,isSigning:B}=((e,s,t,i)=>{const n=(0,x.mx)(),{publicKey:a,walletType:r}=(0,b.rT)(),{getSendConnection:o}=(0,h.U)(),{origin:d}=(0,g.N)(),{isBlockhashExpiredRef:l}=(0,y.C)(),[c,m]=(0,u.useState)(!1),w=async()=>{await(i?.({type:"reject"})),t()};return{sign:async({autoApprove:t=!1}={})=>{try{m(!0);const c=await(0,A.pE)(n,j().encode((0,p.toByteArray)(e)));if(l.current)return;if(f.L3)try{await o({origin:d??"",autoApprove:t??!1,method:"sign"}).sendRawTransaction(j().decode(c))}catch{}await(i?.({type:"sign",autoApprove:t})),s(c,{publicKey:a,walletType:r,autoApprove:t})}catch(e){if(l.current)return;await w()}finally{m(!1)}},reject:w,isSigning:c}})(T[0],s,t,C);return(0,c.d)((()=>k({autoApprove:!0}))),(0,i.jsx)(r.BY,{title:(0,i.jsx)(a.PageTitle,{center:m("approve_transaction_one")}),simulationResults:v,isLoading:_,isSigning:B,onApprove:k,onReject:K,analysisPreview:(0,d.Zb)(v)&&(0,i.jsx)(a.TXSimulationList,{children:v.transactions.map(((e,s)=>(0,i.jsx)(r.ND,{transaction:e,rawTransaction:T[0]},s)))})})}},"../../libs/shared/dist/features/dappCommunication/components/SignTransactionMessage/index.js":(e,s,t)=>{t.d(s,{J:()=>_});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/features/transactionAnalysis/components/index.js"),o=t("../../libs/shared/dist/features/transactionAnalysis/queries/index.js"),d=t("../../libs/shared/dist/features/transactionAnalysis/utils/index.js"),l=t("../../libs/shared/dist/features/dappCommunication/hooks/index.js"),c=t("../../libs/shared/dist/features/dappCommunication/hooks/useAutoApprove.js"),u=t("../../../node_modules/react/index.js"),p=t("../../../node_modules/@solana/web3.js/lib/index.browser.esm.js"),m=t("../../../node_modules/base64-js/index.js"),j=t("../../../node_modules/bs58/index.js"),h=t.n(j),y=t("../../libs/shared/dist/context/solana/useDappSolanaConnection.js"),x=t("../../libs/shared/dist/features/transactionAnalysis/context/index.js"),b=t("../../libs/shared/dist/features/transactionFlow/hooks/index.js"),f=t("../../libs/shared/dist/features/walletData/hooks/index.js"),g=t("../../libs/shared/dist/features/dappCommunication/constants.js"),A=t("../../libs/shared/dist/features/dappCommunication/context/index.js"),w=t("../../libs/shared/dist/features/dappCommunication/utils/index.js");const _=({message:e,onSign:s,onReject:t})=>{const{t:j}=(0,n.$)(),_=(0,l.bL)(e),{simulationResults:v,isPending:T,queryKey:S}=(0,o.mG)(_,"signTransaction"),C=(0,l.j2)({queryKey:S}),{sign:k,reject:K,transaction:B}=((e,s,t,i)=>{const{getSendConnection:n}=(0,y.U)(),a=(0,b.mx)(),{publicKey:r,walletType:o}=(0,f.rT)(),{origin:d}=(0,A.N)(),{isBlockhashExpiredRef:l}=(0,x.C)(),[c,j]=(0,u.useState)(!1),_=(0,u.useMemo)((()=>{if(!e)return"";const s=p.VersionedMessage.deserialize((0,m.toByteArray)(e)),t=new p.VersionedTransaction(s);return(0,m.fromByteArray)(t.serialize())}),[e]),v=async()=>{await(i?.({type:"reject"})),t()};return{sign:async({autoApprove:t=!1}={})=>{try{j(!0);const c=(0,m.toByteArray)(e),u=await(0,w.XO)(a,h().encode(c));if(l.current)return;if(g.L3)try{const e=p.VersionedMessage.deserialize(c),s=new p.VersionedTransaction(e);s.addSignature(new p.PublicKey(a.publicKey),h().decode(u));const i=n({origin:d??"",autoApprove:t??!1,method:"sign"});await i.sendRawTransaction(s.serialize())}catch{}await(i?.({type:"sign",autoApprove:t})),s(u,{publicKey:r,walletType:o,autoApprove:t})}catch(e){if(l.current)return;await v()}finally{j(!1)}},reject:v,message:e,transaction:_,isSigning:c}})(_[0],s,t,C);return(0,c.d)((()=>k({autoApprove:!0}))),(0,i.jsx)(r.BY,{title:(0,i.jsx)(a.PageTitle,{center:j("approve_transaction_one")}),simulationResults:v,isLoading:T,onReject:K,onApprove:k,analysisPreview:(0,d.Zb)(v)&&(0,i.jsx)(a.TXSimulationList,{children:v.transactions.map(((e,s)=>(0,i.jsx)(r.ND,{transaction:e,rawTransaction:B},s)))})})}},"../../libs/shared/dist/features/dappCommunication/constants.js":(e,s,t)=>{t.d(s,{L3:()=>a,Rl:()=>n,ZD:()=>r});var i=t("../../libs/shared/dist/utils/extension.js");const n=.001,a=i.Qd||i.$L,r=i.p1&&!i.Qd},"../../libs/shared/dist/features/dappCommunication/hooks/index.js":(e,s,t)=>{t.d(s,{bL:()=>b,ZY:()=>f,j2:()=>j});var i=t("../../../node_modules/react/index.js"),n=t("../../../node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js"),a=t("../../../node_modules/lodash/lodash.js"),r=t("../../libs/shared/dist/constants/mints.js"),o=t("../../libs/shared/dist/features/featureFlags/index.js"),d=t("../../libs/shared/dist/features/shared/autoApproveApps/index.js"),l=t("../../libs/shared/dist/features/shared/autoApproveApps/utils/isHostInAllowedAutoApprovedList.js"),c=t("../../libs/shared/dist/features/transactionAnalysis/types.js"),u=t("../../libs/shared/dist/features/transactionAnalysis/utils/index.js"),p=t("../../libs/shared/dist/features/dappCommunication/constants.js"),m=t("../../libs/shared/dist/features/dappCommunication/context/index.js");const j=({queryKey:e})=>{const s=(0,n.NL)(),{origin:t,host:j,blinkUrl:h}=(0,m.N)();(0,d.L)();const y=(0,i.useCallback)((async({autoApprove:i})=>{const n=s.getQueryState(e),d=s.getQueryData(["allowedAutoApproveApps"])??[],m=(0,l.y)(j,d),y={dappUrl:t,autoApprove:i,isDappOnAutoApproveList:m};if(n&&"pending"!==n.status){const s=n.data;(0,u.Zb)(s)?(e.includes("message-simulation")||(y.isFinancialTransaction=s.transactions.some((e=>{if((0,a.isEmpty)(e.changes))return!1;if(e.changes.filter((e=>(0,u.FO)(e.amount))).length>1)return!0;const s=e.changes[0].amount;return!!((0,u.FO)(s)&&s?.mint===r.BH&&Math.abs(+s?.amount)>p.Rl)})),y.isSimulationSuccessful=s.transactions.every((e=>!e.isFailedSimulation)),y.numberOfTokenDelegations=s.meta.countTokenDelegations,y.numberOfStakeDelegations=s.meta.countStakingChanges,y.numberOfNftDelegations=s.meta.countNftDelegations,y.networkFeeInSol=(0,a.sumBy)(s.transactions,(e=>e.networkFee?+e.networkFee.amount:0)),y.maliciousPossible=s.transactions.some((e=>e.alerts.some((e=>e.key===c.B.MALICIOUS_POSSIBLE))))||s.alerts.some((e=>e.key===c.B.MALICIOUS_POSSIBLE)),y.insufficientFunds=s.transactions.some((e=>e.alerts.some((e=>e.key===c.B.INSUFFICIENT_FUNDS)))),y.insufficientSol=s.transactions.some((e=>e.alerts.some((e=>e.key===c.B.INSUFFICIENT_SOL)))),y.hasSlippageError=s.transactions.some((e=>e.alerts.some((e=>e.key===c.B.SLIPPAGE_ERROR)))),y.numberOfWritableAccounts=s.meta.countWritable),y.isToggleDisplayed=!!s.actionText,y.didSecurityVerificationFail=(0,u.AB)(s),y.didDynamicVerificationFail=!1):(0,u.$u)(s)?(y.isToggleDisplayed=!0,y.didSecurityVerificationFail=!1,y.didDynamicVerificationFail=!0):(y.isToggleDisplayed=!0,y.didSecurityVerificationFail=!0,y.didDynamicVerificationFail=!0)}await(0,o.Or)(y),h&&""!==h.trim()&&await(0,o.Yk)({blinkUrl:h,dappUrl:t,autoApprove:i})}),[h,j,t,s,e]);return(0,i.useCallback)((async e=>{const s="sign"===e.type&&(e.autoApprove??!1);try{await y({autoApprove:s})}catch{}}),[y])};var h=t("../../../node_modules/base64-js/index.js"),y=t("../../../node_modules/bs58/index.js"),x=t.n(y);const b=e=>(0,i.useMemo)((()=>(Array.isArray(e)?e:[e]).map((e=>{try{const s=x().decode(e);return(0,u.XH)(s),(0,h.fromByteArray)(s)}catch(e){return null}})).filter(Boolean)),[e]),f=e=>(0,i.useMemo)((()=>(Array.isArray(e)?e:[e]).map((e=>{try{const s=x().decode(e);return(0,u.EA)(s),(0,h.fromByteArray)(s)}catch(e){return null}})).filter(Boolean)),[e])},"../../libs/shared/dist/features/dappCommunication/hooks/useAutoApprove.js":(e,s,t)=>{t.d(s,{d:()=>d});var i=t("../../../node_modules/react/index.js"),n=t("../../libs/wallet-core/dist/shared.js"),a=t("../../libs/shared/dist/storage/solflareService.js"),r=t("../../libs/shared/dist/features/walletData/hooks/index.js"),o=t("../../libs/shared/dist/features/dappCommunication/context/index.js");const d=e=>{const{origin:s}=(0,o.N)(),{publicKey:t,walletType:d}=(0,r.rT)();(0,i.useEffect)((()=>{d!==n.CO&&d!==n.R7&&d!==n.vn||(async()=>{const i=await a.Z.solflaretrustedappsperwallet.get(),n=i[t]?.[s];n?.autoApprove&&e()})()}),[d])}},"../../libs/shared/dist/features/dappCommunication/modals/BlockedOriginModal/index.js":(e,s,t)=>{t.d(s,{a:()=>o});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/components/index.js");const o=({host:e,title:s,onReject:t})=>{const{t:o}=(0,n.$)();return(0,i.jsx)(a.PagePortal,{size:"fullPage",children:(0,i.jsxs)(a.FullPageConfirm,{children:[(0,i.jsx)(a.PageTitle,{center:o("dapp_communication_blocked_origin_title")}),(0,i.jsxs)(a.PageContent,{gap:"l",children:[(0,i.jsx)(a.AppInteractionHero,{title:s||e,subtitle:s?e:void 0,avatar:(0,i.jsx)(r.iB,{host:e,size:"l"})}),(0,i.jsx)(a.TxErrorMessage,{actions:(0,i.jsx)(a.Button,{onClick:()=>window.open("https://help.solflare.com/en/","_blank"),size:"s",variant:"tertiary",left:(0,i.jsx)(a.Icon,{icon:"open_in_new"}),children:o("action_contact_support")}),children:(0,i.jsx)(a.Paragraph,{children:o("dapp_communication_blocked_origin_paragraph")})}),(0,i.jsx)(a.FooterActions,{variant:"inContent",children:(0,i.jsx)(a.ButtonGroup,{children:(0,i.jsx)(a.Button,{onClick:()=>t(),children:o("action_back_to_safety")})})})]})]})})}},"../../libs/shared/dist/features/dappCommunication/utils/decodeSignMessage.js":(e,s,t)=>{t.d(s,{m:()=>i});const i=(e,s="utf8")=>{try{return"hex"===s?`0x${t=e,Array.prototype.map.call(t,(e=>`00${e.toString(16)}`.slice(-2))).join("")}`:(new TextDecoder).decode(e)}catch{return}var t}},"../../libs/shared/dist/features/dappCommunication/utils/index.js":(e,s,t)=>{t.d(s,{my:()=>i.m,nO:()=>o,mW:()=>d,Se:()=>l,l:()=>c,pE:()=>u,XO:()=>p});var i=t("../../libs/shared/dist/features/dappCommunication/utils/decodeSignMessage.js"),n=t("../../../node_modules/@solana/web3.js/lib/index.browser.esm.js"),a=(t("../../../node_modules/base64-js/index.js"),t("../../../node_modules/bs58/index.js")),r=t.n(a);const o=e=>{try{const s=n.VersionedMessage.deserialize(e);return!!s&&s.header?.numRequiredSignatures<=64&&!!s.recentBlockhash&&s.compiledInstructions?.length>0}catch(e){return!1}},d=async(e,s)=>{if(!e.publicKey)throw new Error("Wallet not connected");const t=s.map((e=>n.VersionedTransaction.deserialize(r().decode(e)))),i=await e.signAllTransactions(t.map((e=>e.message.serialize())));if(!i)throw new Error("Transactions rejected");return t.map(((s,t)=>(s.addSignature(new n.PublicKey(e.publicKey),i[t]),s))).map((e=>r().encode(e.serialize())))},l=async(e,s)=>{if(!e.publicKey)throw new Error("Wallet not connected");const t=await e.signAllTransactions(s.map((e=>r().decode(e))));if(!t)throw new Error("Transaction rejected");return t.map((e=>r().encode(e)))},c=async(e,s)=>{if(!e.publicKey)throw new Error("Wallet not connected");const t=await e.signMessage(r().decode(s));if(!t)throw new Error("Transaction rejected");return r().encode(t)},u=async(e,s)=>{if(!e.publicKey)throw new Error("Wallet not connected");const t=n.VersionedTransaction.deserialize(r().decode(s)),i=await e.signTransaction(t.message.serialize());if(!i)throw new Error("Transaction rejected");return t.addSignature(new n.PublicKey(e.publicKey),i),r().encode(t.serialize())},p=async(e,s)=>{if(!e.publicKey)throw new Error("Wallet not connected");const t=await e.signTransaction(r().decode(s));if(!t)throw new Error("Transaction rejected");return r().encode(t)}},"../../libs/shared/dist/features/recentAddresses/constants.js":(e,s,t)=>{t.d(s,{x:()=>i});const i=30},"../../libs/shared/dist/features/transactionAnalysis/components/index.js":(e,s,t)=>{t.d(s,{BY:()=>i.B,ND:()=>n.N,Nr:()=>o.N,RD:()=>r.R,W2:()=>a.W});var i=t("../../libs/shared/dist/features/transactionAnalysis/components/AnalysisRenderer/index.js"),n=t("../../libs/shared/dist/features/transactionAnalysis/components/DynamicAnalysisTransaction/index.js"),a=t("../../libs/shared/dist/features/transactionAnalysis/components/Container/index.js"),r=t("../../libs/shared/dist/features/transactionAnalysis/components/AnalysisBlockedAction/index.js"),o=t("../../libs/shared/dist/features/transactionAnalysis/components/AnalysisRendererContent/index.js")},"../../libs/shared/dist/features/transactionAnalysis/context/blockhashExpired/index.js":(e,s,t)=>{t.d(s,{C:()=>l,y:()=>d});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react/index.js"),a=t("../../libs/shared/dist/features/transactionFlow/context/index.js"),r=t("../../libs/shared/dist/features/transactionAnalysis/constants.js");const o=(0,n.createContext)(null),d=({resetKey:e,timerEnabled:s,children:t})=>{const[d,l]=(0,n.useState)(!1),c=(0,n.useRef)(!1),{setIsLedgerPending:u,setIsKeystonePending:p}=(0,a.p)();(0,n.useEffect)((()=>{if(l(!1),c.current=!1,!s)return;const e=setInterval((()=>{c.current=!0,l(!0),u(!1),p(!1)}),r.t);return()=>{clearInterval(e)}}),[e,p,u,s]);const m=(0,n.useMemo)((()=>({isBlockhashExpired:d,isBlockhashExpiredRef:c})),[d]);return(0,i.jsx)(o.Provider,{value:m,children:t})},l=()=>{const e=(0,n.useContext)(o);if(null===e)throw new Error("useBlockhashExpired must be used within a BlockhashExpiredProvider");return e}},"../../libs/shared/dist/features/transactionAnalysis/queries/index.js":(e,s,t)=>{t.d(s,{cK:()=>x,mG:()=>j.m,My:()=>m});var i=t("../../../node_modules/react/index.js"),n=t("../../../node_modules/@tanstack/react-query/build/modern/useQuery.js"),a=t("../../../node_modules/lodash/lodash.js"),r=t("../../libs/shared/dist/features/currencies/hooks/index.js"),o=t("../../libs/shared/dist/features/dappCommunication/context/index.js"),d=t("../../libs/shared/dist/features/globalConfig/hooks/index.js"),l=t("../../libs/shared/dist/features/settings/index.js"),c=t("../../libs/shared/dist/features/walletData/hooks/index.js"),u=t("../../libs/shared/dist/features/transactionAnalysis/api/index.js"),p=t("../../libs/shared/dist/features/transactionAnalysis/utils/index.js");const m=(e,s,t=!0)=>{const{publicKey:m}=(0,c.rT)(),j=(0,d.LN)(),h=(0,r.Af)(),{current:y}=(0,l.ix)(),{host:x}=(0,o.N)(),b=(0,i.useMemo)((()=>["transactions-simulation",m,j,x,e]),[m,j,x,e]),{data:f,isPending:g,isError:A,error:w,refetch:_}=(0,n.a)({queryKey:b,queryFn:async()=>(0,u.J)({transactions:e.map((e=>({payload:e,type:"wireTransaction"}))),method:s,publicKey:m,cluster:j.cluster,host:x??"",currency:h.ticker,language:y}),retry:!1,enabled:!(0,a.isEmpty)(e)&&!(0,a.isEmpty)(e[0])&&!!x&&t}),v=(0,i.useMemo)((()=>{try{return(0,p.Zb)(f)?f.transactions.map((e=>e.enrichedTx)):e}catch{return e}}),[f,e]);return{error:w,isError:A,isPending:g,simulationResults:f,serializedTransactions:v,refetch:_,queryKey:b}};var j=t("../../libs/shared/dist/features/transactionAnalysis/queries/useTransactionMessagesAnalysisQuery.js"),h=t("../../../node_modules/base64-js/index.js"),y=t("../../libs/shared/dist/features/dappCommunication/utils/index.js");const x=e=>{const{publicKey:s}=(0,c.rT)(),t=(0,d.LN)(),a=(0,r.Af)(),{current:p}=(0,l.ix)(),{host:m}=(0,o.N)(),j=(0,i.useMemo)((()=>(0,y.nO)((0,h.toByteArray)(e))),[e]),x=(0,i.useMemo)((()=>["message-simulation",s,t,m,e]),[m,e,t,s]),{data:b,isPending:f,isError:g,error:A,refetch:w}=(0,n.a)({queryKey:x,queryFn:()=>(0,u.J)({transactions:e?[{payload:e,type:"compiledMessage"}]:[],method:"signMessage",publicKey:s,cluster:t.cluster,host:m??"",currency:a.ticker,language:p}),retry:!1,enabled:!j&&!!m});return{error:A,isError:g,isPending:f,simulationResults:b,refetch:w,isTransactionDetected:j,queryKey:x}}},"../../libs/shared/dist/features/transactionAnalysis/utils/index.js":(e,s,t)=>{t.d(s,{M3:()=>n,FO:()=>a,TX:()=>c,$u:()=>l,O9:()=>r,Zb:()=>o,AB:()=>d,EA:()=>p,XH:()=>u});var i=t("../../../node_modules/@solana/web3.js/lib/index.browser.esm.js");const n=e=>e?"object"==typeof e?`${e.amount}${e.symbol?` ${e.symbol}`:""}`:e??"":"",a=e=>!!e?.amount,r=e=>!!e,o=e=>r(e)&&(0===e.errors.length||e.errors.every((e=>"static_simulation_failed"===e))),d=e=>o(e)&&e.errors.includes("static_simulation_failed"),l=e=>r(e)&&e.errors.every((e=>"dynamic_simulation_failed"===e)),c=e=>!r(e)&&!l(e),u=e=>{try{return i.VersionedMessage.deserialize(e).serialize(),!0}catch{throw new Error("Invalid transaction message")}},p=e=>{try{return i.VersionedTransaction.deserialize(e).serialize(),!0}catch{throw new Error("Invalid transaction")}}},"../../libs/shared/dist/features/transactionFlow/components/LedgerConfirm/index.js":(e,s,t)=>{t.d(s,{D:()=>l});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../../node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js"),r=t("../../libs/foundation-ui/dist/index.js"),o=t("../../libs/shared/dist/assets/ledger_device.png");const d=a.Z.img`
  width: 100%;
`,l=({title:e})=>{const{t:s}=(0,n.$)();return(0,i.jsx)(r.PagePortal,{size:"fullPage",children:(0,i.jsxs)(r.FullPageConfirm,{children:[(0,i.jsx)(r.PageTitle,{center:e||s("confirm_transaction_title")}),(0,i.jsxs)(r.PageContent,{children:[(0,i.jsx)(r.Section,{children:(0,i.jsx)(r.Paragraph,{size:"m",children:s("approve_ledger_transaction")})}),(0,i.jsx)(d,{src:o,alt:"Ledger"})]})]})})}},"../../libs/shared/dist/features/transactionFlow/utils/index.js":(e,s,t)=>{t.d(s,{g:()=>n.g,l:()=>i.l});var i=t("../../libs/shared/dist/features/transactionFlow/utils/snackbar.js"),n=t("../../libs/shared/dist/features/transactionFlow/utils/confirmTransaction.js")},"../../libs/shared/dist/hooks/useSearchMultiple.js":(e,s,t)=>{t("../../../node_modules/react/index.js"),t("../../../node_modules/lodash/lodash.js")},"../../libs/shared/dist/hooks/useStorageItem.js":(e,s,t)=>{t("../../../node_modules/react/index.js"),t("../../libs/shared/dist/storage/solflareService.js")},"../../libs/shared/dist/assets/ledger_device.png":(e,s,t)=>{e.exports=t.p+"static/assets/ledger_device.3f6f9254..png"}}]);
//# sourceMappingURL=libs_shared_dist_components_FullScreenLoading_index_js-libs_shared_dist_components_ValidatorA-cc1b15.js.map